unit Sys_uComPrm;

interface
uses Windows;

type
  InputStrParams = array[0..11] of shortstring;

function GrepCommandParams(var iprm: inputStrParams;
                           const ConfigDel: array of string;
                           sLogFileName: string; const isFileLogged: bool=TRUE): integer;

var
  sysMainExePath: string;

implementation
uses
  rxstrutils,SysUtils,
  Sys_uLog,
  Sys_StrConv,Sys_iStrUtils;

function GrepCommandParams(var iprm: inputStrParams; const ConfigDel: array of string;
                           sLogFileName: string; const isFileLogged: bool=TRUE): integer;
var
  s: string;
  i,idpos,ips: integer;
begin
  fillchar(iprm, sizeof(iprm),0);
  ips := 0;
  sysMainExePath := ExtractFilePath(paramstr(0));

  for i := 1 to paramCount do begin // commandline
    s := trim(paramStr(i));
    if (npos('-',s,1) =1) or (npos('/',s,1) =1) then
      s := trim(copy(s,2,length(s)));

    if result =0 then
      result := str2Int(s);

    if IsSubStrArr(ConfigDel, s, idpos, $01) >0 then begin

//    if length(s) <4 then
       iprm[idpos] := trim( paramstr(i+1));
{     else
       iprm[idpos] := trim( copy(s,4,length(s)));}
      inc(idpos);
     end
    else
    if (s <>iprm[0]) and (str2int(s) =0) then begin
      inc(ips);
      iprm[ips] := s;
    end;
  end;
end;


end.
